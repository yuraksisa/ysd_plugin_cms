<%= include('entity-management') %>

<!-- Renders the elements container -->
<script type="text/tmpl" id="elements_container_template">

</script>

<!-- Renders one element in the elements list view -->
        
<script type="text/tmpl" id="elements_list_template">

</script>

<!-- Renders one element in the element view (full detailed) -->

<script type="text/tmpl" id="element_template">

</script>

<!-- Renders the form to edit an element -->

<script type="text/tmpl" id="element_template_form">

  <form name="content_translation" id="content_translation">

    <div class="top-navigation-bar navigation-bar">
       <h2 class="form-title">Menu item translation</h2>
       <div class="navigation-bar-nav-buttons">
       </div>
    </div>        

    <input type="hidden" name="menu_item_id" value="<%=menu_item_id%>"/>

    <div class="form-fields">
    
      <div class="formrow">
        <label for="language" class="fieldtitle">Language <span class="mandatoryfield">*</span></label>
        <select name="language" id="language" class="fieldcontrol"/> 
        <div class="fielddescription">The translation language.</div>
      </div>

      <div class="formrow">
         <label for="title" class="fieldtitle">Title <span class="mandatoryfield">*</span></label>
         <input type="text" id="title" name="title" class="fieldcontrol" maxlength="80" <%% if (entity) { %> value="<%%= entity.title %>" <%% } %>/>
      </div>

      <div class="formrow">
        <label for="name" class="fieldtitle">Description</label>
        <input type="text" maxlength="256" id="description" name="description" class="fieldcontrol" <%% if (entity) { %> value="<%%= entity.description %>" <%% } %> />
      </div>
    
      </div>
      <div class="bottom-navigation-bar navigation-bar">
        <div class="navigation-bar-nav-buttons">
           <input type="submit" class="update-entity-button action-button entity-management-button" value="Update"/>
        </div>
      </div>
    </div>
  </form>
  
</script>

<script type="text/javascript">

require(['jquery','YSDEntityManagement', 'YSDRemoteDataSource', 'YSDSelectSelector'],
        function($, EntityManagement, RemoteDataSource, SelectSelector) {

  function MenuItemTranslationHook() {
 	   
  	this.onEdit = function(entity) {
  	  this.configForm(entity);	
  	}
  	
  	this.onNew = function() {
  	  this.configForm(null);	
  	}
  	
    this.onRenderEntities = function(entities) {
    
      $('.new-entity-button').hide();
      $('.edit-entity-button').hide();
      $('.page-navigation').hide();
      	
    }
    
    this.configForm = function(entity) {       
    
      var dataSource = new RemoteDataSource('/translationlanguages',{id:'code', description:'description'});
      var value = (this.entity && this.entity.language)?this.entity.language:'<%=language%>'; 
      var selector = new SelectSelector('language', dataSource, value );
      
      $('#language').change(function(event) { 
      	  self.changeLanguage(event) 
      	 });    	
    }
    
    this.changeLanguage = function(event) {
      
      var language = $('#language option:selected').val();	
      
      // 
      
    }
  	  	
  };
  
  var urls = {
               get_url        : '/translation/<%=language%>/menuitem/<%=menu_item_id%>',
               update_url     : '/translation/menuitem'
             };
             
  var menuItemTranslationHook = new MenuItemTranslationHook();
  var menuItemTranslation = new EntityManagement(urls, 'content translation', 1, menuItemTranslationHook, 
                                               {url_base: '/translate/menuitem', action: 'edit'});
 
  $('.entity-title').html('Menu item translation');
  
 });

</script>